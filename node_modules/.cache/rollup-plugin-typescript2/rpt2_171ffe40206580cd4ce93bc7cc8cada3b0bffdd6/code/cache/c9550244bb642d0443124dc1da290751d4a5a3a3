{"code":"const patchClass = (el, value) => {\r\n    if (value == null) {\r\n        value = '';\r\n    }\r\n    el.className = value;\r\n};\r\nconst patchStyle = (el, prev, next) => {\r\n    const style = el.style; // 获取样式\r\n    if (next == null) {\r\n        el.removeAttribute('style'); // 如果新的没有 直接移除样式即可\r\n    }\r\n    else {\r\n        // 老的有新的没有\r\n        if (prev) {\r\n            for (let key in prev) {\r\n                if (next[key] == null) {\r\n                    // 老的有 新的没有 需要删除\r\n                    style[key] = '';\r\n                }\r\n            }\r\n        }\r\n        for (let key in next) {\r\n            // 新的需要赋值到style上\r\n            style[key] = next[key];\r\n        }\r\n    }\r\n};\r\n// 1.给元素缓存一个绑定事件的列表\r\n// 2.如果缓存中没有缓存过的，而且value有值 需要绑定方法，并且缓存起来\r\n// 3.以前绑定过需要删除掉，删除缓存\r\n// 4.如果前后都有，直接改变invoker中value属性指向最新的事件 即可\r\nconst patchEvent = (el, key, value) => {\r\n    // 对函数的缓存\r\n    const invokers = el._vei || (el._vei = {});\r\n    const exists = invokers[key];\r\n    if (value && exists) {\r\n        // 需要绑定事件 而且存在的情况下\r\n        exists.value = value; // 替换事件 但是不用解绑\r\n    }\r\n    else {\r\n        const eventName = key.slice(2).toLowerCase();\r\n        if (value) {\r\n            // 绑定事件\r\n            let invoker = (invokers[key] = createInvoker(value));\r\n            el.addEventListener(eventName, invoker);\r\n        }\r\n        else {\r\n            // 以前绑定了 但是没有value\r\n            el.removeremoveEventListener(eventName, exists);\r\n            invokers[key] = undefined;\r\n        }\r\n    }\r\n};\r\nfunction createInvoker(value) {\r\n    const invoker = (e) => {\r\n        invoker.value(e);\r\n    };\r\n    invoker.value = value; // 为了能随时更改value属性\r\n    return invoker;\r\n}\r\nconst patchAttr = (el, key, value) => {\r\n    if ((value = null)) {\r\n        el.removeAttribute(key);\r\n    }\r\n    else {\r\n        el.setAttribute(key, value);\r\n    }\r\n};\r\nexport const patchProp = (el, key, prevValue, nextValue) => {\r\n    switch (key) {\r\n        case 'class':\r\n            patchClass(el, nextValue); // 比对属性\r\n            break;\r\n        case 'style':\r\n            patchStyle(el, prevValue, nextValue);\r\n            break;\r\n        default:\r\n            // 如果不是事件 才是属性\r\n            if (/^on[^a-z]/.test(key)) {\r\n                // 事件就是增加和删除 修改 addEventListener\r\n                patchEvent(el, key, nextValue);\r\n            }\r\n            else {\r\n                // 其他属性 直接使用setAttribute\r\n                patchAttr(el, key, nextValue);\r\n            }\r\n            break;\r\n    }\r\n};\r\n//# sourceMappingURL=patchProp.js.map","references":[],"map":"{\"version\":3,\"file\":\"patchProp.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../../../packages/runtime-dom/src/patchProp.ts\"],\"names\":[],\"mappings\":\"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\"}"}
